# !!! FILE MANAGED BY SALT !!!

#
# Shorewall version {{ pkg_version }} -- /etc/shorewall/mangle
#
# For information about entries in this file, type "man shorewall-mangle"
#
# See http://shorewall.net/traffic_shaping.htm for additional information.
# For usage in selecting among multiple ISPs, see
# http://shorewall.net/MultiISP.html
#
# See http://shorewall.net/PacketMarking.html for a detailed description of
# the Netfilter/Shorewall packet marking mechanism.
#
####################################################################################################################################################
#ACTION		SOURCE		DEST		PROTO	DPORT	SPORT	USER	TEST	LENGTH	TOS	CONNBYTES	HELPER	PROBABILITY	DSCP

{%- for rule in salt['pillar.get']('shorewall:mangle', []) %}
{#- skip if ip version does not match #}
{%-   if rule.ipv is defined and rule.ipv != ipv %}{% continue %}{% endif %}

{{ rule.get('action') }}     {{ rule.get('source', '0.0.0.0/0') }}     {{ rule.get('dest', '0.0.0.0/0') }}     {{ rule.get('proto', '-') }}      {{ rule.get('port', '-') }}     {{ rule.get('sport', '-') }}     {{ rule.get('user', '-') }}     {{ rule.get('test', '-') }}     {{ rule.get('length', '-') }}     {{ rule.get('tos', '-') }}     {{ rule.get('connbytes', '-') }}     {{ rule.get('helper', '-') }}     {{ rule.get('probability', '-') }}     {{ rule.get('dscp', '-') }}     {{ rule.get('state', '') }}

{%- endfor %}

